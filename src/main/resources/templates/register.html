<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Title</title>
    <script src="lib/jquery.1.8.3.min.js"></script>
</head>
<body style="text-align: center;">
<a href="/">首页</a>
<h2>注册</h2>

<form id="mainForm" action="javascript:void();">
    用户名:<input name="username" value=""/>
    <br />
    密码:<input name="password" value="123456"/>
    <br />
    邮箱:<input name="email" value=""/>
    <br />
    手机号:<input name="phone" value=""/>
    <br />
    验证码:<input name="checkCode" value=""/>
    <a href="javascript:getCheckCode();">获取验证码</a>
    <br />
    <input value="注册" type="submit" />
</form>
<script>

    $.fn.serializeJson = function () {
        var serializeObj = {};
        $(this.serializeArray()).each(function () {
            serializeObj[this.name] = this.value;
        });
        return serializeObj;
    };




    $("#mainForm").submit(function(){
        var data = $(this).serializeJson();

        $.post("/user/register",data,function(result){
                alert("注册成功");
        },"json").error(function(xhr){
            if(xhr.status==400){
                alert(xhr.responseText);
            }else{
                alert("出错了,请刷新页面后重试"+xhr.status);
            }
            console.log(arguments);
        });

        return false;
    });


    function getCheckCode(){
        var data = $("#mainForm").serializeJson();
        if(!data.email){
            alert("请输入邮箱");
            return;
        }
        $.getJSON("/user/auth?mail="+data.email,function(result){
            alert("验证码已经发送到你的邮箱,请查收");
        }).error(function(){
            alert("出错了,请刷新页面后重试");
        });

    }


</script>



<script>

</script>




</body>
</html>